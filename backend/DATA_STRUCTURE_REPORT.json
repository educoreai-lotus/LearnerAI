{
  "service_name": "learnerAI",
  "description": "LearnerAI service data sync for RAG: courses (learning paths) from Supabase 'courses' table, returned via GRPC Process (realtime + batch). Additionally, recommendations from 'recommendations' table are sent to RAG separately.",
  "version": "1.0.0",
  "data_sources": {
    "courses": {
      "table": "courses",
      "description": "Learning paths (courses) sent via GRPC Process endpoint",
      "data_structure": {
        "competency_target_name": "string",
        "user_id": "string",
        "gap_id": "string",
        "learning_path": "object",
        "approved": "boolean",
        "created_at": "datetime",
        "last_modified_at": "datetime"
      },
      "field_descriptions": {
        "competency_target_name": "Primary key / course identifier (also used as learning path id).",
        "user_id": "Learner UUID that owns this course.",
        "gap_id": "Related skills_gap.gap_id (nullable).",
        "learning_path": "Prompt-3 structured JSON with exact field order: path_title → learner_id → total_estimated_duration_hours → learning_modules.",
        "approved": "Whether the learning path is approved (boolean: true/false).",
        "created_at": "When the course record was created.",
        "last_modified_at": "When the course record was last modified."
      },
      "learning_path_structure": {
        "path_title": "string",
        "learner_id": "uuid",
        "total_estimated_duration_hours": "number",
        "learning_modules": [
          {
            "module_order": "number",
            "module_title": "string",
            "estimated_duration_hours": "number",
            "skills_in_module": ["string"],
            "steps": [
              {
                "step": "number",
                "title": "string",
                "description": "string",
                "estimatedTime": "number",
                "skills_covered": ["string"]
              }
            ]
          }
        ]
      },
      "sample_data": {
        "competency_target_name": "C++ basics Noam",
        "user_id": "b2b400ed-bc11-4aa9-a89e-f4a00d0f6321",
        "gap_id": "550e8400-e29b-41d4-a716-446655440000",
        "learning_path": {
          "path_title": "C++ basics Noam",
          "learner_id": "b2b400ed-bc11-4aa9-a89e-f4a00d0f6321",
          "total_estimated_duration_hours": 37.5,
          "learning_modules": [
            {
              "module_order": 1,
              "module_title": "C++ Programming Fundamentals",
              "estimated_duration_hours": 6.5,
              "skills_in_module": [
                "Variables and Data Types",
                "Input and Output (cin, cout)",
                "Control Flow (if, switch, loops)"
              ],
              "steps": [
                {
                  "step": 1,
                  "title": "Understanding Variables and Data Types",
                  "description": "Learn the fundamental building blocks of C++: how to declare variables to store different types of data like integers, floating-point numbers, and characters.",
                  "estimatedTime": 1.5,
                  "skills_covered": ["Variables and Data Types"]
                },
                {
                  "step": 2,
                  "title": "Basic Input and Output",
                  "description": "Discover how to make your programs interactive by reading input from the user with 'cin' and displaying output to the console with 'cout'.",
                  "estimatedTime": 1,
                  "skills_covered": ["Input and Output (cin, cout)"]
                }
              ]
            }
          ]
        },
        "approved": false,
        "created_at": "2025-12-18T10:00:00.000Z",
        "last_modified_at": "2025-12-18T10:15:00.000Z"
      }
    },
    "recommendations": {
      "table": "recommendations",
      "description": "Course suggestions (Prompt 4 output) sent to RAG separately",
      "data_structure": {
        "recommendation_id": "uuid",
        "user_id": "string",
        "base_course_name": "string",
        "suggested_courses": "object",
        "sent_to_rag": "boolean",
        "created_at": "datetime",
        "last_modified_at": "datetime"
      },
      "field_descriptions": {
        "recommendation_id": "Primary key UUID for the recommendation record.",
        "user_id": "Learner UUID that this recommendation is for.",
        "base_course_name": "The competency_target_name of the completed course (matches courses.competency_target_name).",
        "suggested_courses": "JSONB object containing Prompt 4 output with originalSuggestions, enhancedSuggestions, and ragProcessed flag.",
        "sent_to_rag": "Whether this recommendation has been sent to RAG microservice.",
        "created_at": "When the recommendation record was created.",
        "last_modified_at": "When the recommendation record was last modified."
      },
      "suggested_courses_structure": {
        "originalSuggestions": {
          "suggested_courses": [
            {
              "course_name": "string",
              "reason": "string",
              "difficulty": "string"
            }
          ]
        },
        "enhancedSuggestions": [
          {
            "course_name": "string",
            "ragContent": {
              "similarCourses": ["array"],
              "contentMatches": ["array"],
              "learnerProfileMatch": "string"
            }
          }
        ],
        "ragProcessed": "boolean"
      },
      "sample_data": {
        "recommendation_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
        "user_id": "b2b400ed-bc11-4aa9-a89e-f4a00d0f6321",
        "base_course_name": "C++ basics Noam",
        "suggested_courses": {
          "originalSuggestions": {
            "suggested_courses": [
              {
                "course_name": "Advanced C++ Programming",
                "reason": "Builds on your C++ fundamentals knowledge",
                "difficulty": "intermediate"
              }
            ]
          },
          "enhancedSuggestions": [
            {
              "course_name": "Advanced C++ Programming",
              "ragContent": {
                "similarCourses": ["C++ Object-Oriented Programming"],
                "contentMatches": ["Memory Management", "Templates"],
                "learnerProfileMatch": "High"
              }
            }
          ],
          "ragProcessed": true
        },
        "sent_to_rag": true,
        "created_at": "2025-12-18T10:20:00.000Z",
        "last_modified_at": "2025-12-18T10:25:00.000Z"
      }
    }
  },
  "grpc_process_endpoint": {
    "description": "GRPC Process endpoint returns courses (learning paths) only",
    "realtime_mode": {
      "returns": "Direct array of course records (no wrappers)",
      "example": "[{competency_target_name, user_id, gap_id, learning_path, approved, ...}, ...]"
    },
    "batch_mode": {
      "returns": "Object with items array and pagination",
      "example": "{\"items\": [...], \"page\": 1, \"limit\": 1000, \"total\": 50}"
    }
  },
  "recommendations_to_rag": {
    "description": "Recommendations are sent to RAG separately (not via GRPC Process)",
    "method": "Separate API call or data sync",
    "fields_sent": [
      "user_id",
      "base_course_name (same as competency_target_name)",
      "suggested_courses (Prompt 4 output)"
    ]
  },
  "notes": [
    "GRPC Process endpoint syncs courses table only.",
    "Learning path structure matches Prompt 3 output exactly with field order: path_title → learner_id → total_estimated_duration_hours → learning_modules.",
    "Module structure: module_order → module_title → estimated_duration_hours → skills_in_module → steps (if present).",
    "Step structure: step → title → description → estimatedTime → skills_covered.",
    "Recommendations table data (base_course_name, suggested_courses, user_id) is sent to RAG via separate mechanism, not GRPC Process.",
    "base_course_name in recommendations table matches competency_target_name in courses table."
  ]
}


